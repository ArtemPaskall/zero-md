{"version":3,"file":"zero-md.min.js","sources":["../src/index.js"],"sourcesContent":["export class ZeroMd extends HTMLElement {\n  get src () { return this.getAttribute('src') }\n  set src (val) { this.reflect('src', val) }\n  get manualRender () { return this.hasAttribute('manual-render') }\n  set manualRender (val) { this.reflect('manual-render', val) }\n\n  reflect (name, val) {\n    if (val === false) {\n      this.removeAttribute(name)\n    } else {\n      this.setAttribute(name, val === true ? '' : val)\n    }\n  }\n\n  static get observedAttributes () {\n    return ['src']\n  }\n\n  attributeChangedCallback (name, old, val) {\n    if (name === 'src' && this.connected && !this.manualRender && val !== old) {\n      this.render()\n    }\n  }\n\n  constructor (defaults) {\n    super()\n    this.version = '$VERSION'\n    this.config = {\n      markedUrl: 'https://cdn.jsdelivr.net/gh/markedjs/marked@2/marked.min.js',\n      prismUrl: [\n        ['https://cdn.jsdelivr.net/gh/PrismJS/prism@1/prism.min.js', 'data-manual'],\n        'https://cdn.jsdelivr.net/gh/PrismJS/prism@1/plugins/autoloader/prism-autoloader.min.js'\n      ],\n      cssUrls: [\n        'https://cdn.jsdelivr.net/gh/sindresorhus/github-markdown-css@4/github-markdown.min.css',\n        'https://cdn.jsdelivr.net/gh/PrismJS/prism@1/themes/prism.min.css'\n      ],\n      hostCss: ':host{display:block;position:relative;contain:content;}:host([hidden]){display:none;}',\n      ...defaults,\n      ...window.ZeroMdConfig\n    }\n    this.root = this.hasAttribute('no-shadow') ? this : this.attachShadow({ mode: 'open' })\n    if (!this.constructor.ready) {\n      this.constructor.ready = Promise.all([\n        !!window.marked || this.loadScript(this.config.markedUrl),\n        !!window.Prism || this.loadScript(this.config.prismUrl)\n      ])\n    }\n    this.clicked = this.clicked.bind(this)\n    if (!this.manualRender) {\n      // Scroll to hash id after first render. However, `history.scrollRestoration` inteferes with this on refresh.\n      // It's much better to use a `setTimeout` rather than to alter the browser's behaviour.\n      this.render().then(() => setTimeout(() => this.goto(location.hash), 250))\n    }\n    this._stampedBody = null\n    this._stampedStyles = null\n    this.observeChanges()\n  }\n\n  connectedCallback () {\n    this.connected = true\n    this.fire('zero-md-connected', {}, { bubbles: false, composed: false })\n    this.waitForReady().then(() => {\n      this.fire('zero-md-ready')\n    })\n    if (this.shadowRoot) {\n      this.shadowRoot.addEventListener('click', this.clicked)\n    }\n  }\n\n  disconnectedCallback () {\n    this.connected = false\n    if (this.shadowRoot) {\n      this.shadowRoot.removeEventListener('click', this.clicked)\n    }\n  }\n\n  waitForReady () {\n    const ready = this.connected || new Promise(resolve => {\n      this.addEventListener('zero-md-connected', function handler () {\n        this.removeEventListener('zero-md-connected', handler)\n        resolve()\n      })\n    })\n    return Promise.all([this.constructor.ready, ready])\n  }\n\n  fire (name, detail = {}, opts = { bubbles: true, composed: true }) {\n    if (detail.msg) {\n      console.warn(detail.msg)\n    }\n    this.dispatchEvent(new CustomEvent(name, {\n      detail: { node: this, ...detail },\n      ...opts\n    }))\n  }\n\n  tick () {\n    return new Promise(resolve => requestAnimationFrame(resolve))\n  }\n\n  // Coerce anything into an array\n  arrify (any) {\n    return any ? (Array.isArray(any) ? any : [any]) : []\n  }\n\n  // Promisify an element's onload callback\n  onload (node) {\n    return new Promise((resolve, reject) => {\n      node.onload = resolve\n      node.onerror = err => reject(err.path ? err.path[0] : err.composedPath()[0])\n    })\n  }\n\n  // Load a url or load (in order) an array of urls via <script> tags\n  loadScript (urls) {\n    urls = this.arrify(urls)\n    return Promise.all(urls.map(item => {\n      const [url, ...attrs] = this.arrify(item)\n      const el = document.createElement('script')\n      el.src = url\n      el.async = false\n      attrs.forEach(attr => el.setAttribute(attr, ''))\n      return this.onload(document.head.appendChild(el))\n    }))\n  }\n\n  // Scroll to selected element\n  goto (id) {\n    if (id) {\n      const el = this.root.getElementById(id.substring(1))\n      if (el) {\n        el.scrollIntoView()\n      }\n    }\n  }\n\n  // Hijack same-doc anchor hash links\n  clicked (ev) {\n    if (ev.metaKey || ev.ctrlKey || ev.altKey || ev.shiftKey || ev.defaultPrevented) {\n      return\n    }\n    const a = ev.target.closest('a')\n    if (a && a.hash && a.host === location.host && a.pathname === location.pathname) {\n      this.goto(a.hash)\n    }\n  }\n\n  clearDom () {\n    const nodes = this.root.querySelectorAll('[class^=markdown]')\n    nodes.forEach(n => n.remove())\n  }\n\n  // Converts HTML string into document fragment\n  makeFrag (html) {\n    const tpl = document.createElement('template')\n    tpl.innerHTML = html\n    return tpl.content\n  }\n\n  dedent (str) {\n    str = str.replace(/^\\n/, '')\n    const match = str.match(/^\\s+/)\n    return match ? str.replace(new RegExp(`^${match[0]}`, 'gm'), '') : str\n  }\n\n  getBaseUrl (src) {\n    const a = document.createElement('a')\n    a.href = src\n    return a.href.substring(0, a.href.lastIndexOf('/') + 1)\n  }\n\n  highlight (container) {\n    const unhinted = container.querySelectorAll('pre>code:not([class*=\"language-\"])')\n    unhinted.forEach(n => {\n      // Dead simple language detection :)\n      const lang = n.innerText.match(/^\\s*</) ? 'markup' : n.innerText.match(/^\\s*(\\$|#)/) ? 'bash' : 'js'\n      n.classList.add(`language-${lang}`)\n    })\n    window.Prism.highlightAllUnder(container)\n  }\n\n  // Starts observing for changes in styles or inline content to auto re-render\n  observeChanges () {\n    const stylesObserver = new MutationObserver(() => {\n      if (!this.manualRender) { this.refreshStyles() }\n    })\n    const inlineContentObserver = new MutationObserver(() => {\n      if (!this.manualRender) { this.refreshContent() }\n    })\n    const observeChildren = nodes => [...nodes].forEach(node => {\n      const observeConfig = { childList: true, attributes: true, characterData: true, subtree: true }\n      if (node.matches('script[type=\"text/markdown\"]')) {\n        inlineContentObserver.observe(node, observeConfig)\n      } else if (node.tagName === 'TEMPLATE') {\n        stylesObserver.observe(node.content, observeConfig)\n      }\n    })\n    const rootObserver = new MutationObserver((mutations) => {\n      const addedNodes = []\n      const removedNodes = []\n      mutations.forEach(mutation => {\n        mutation.removedNodes.forEach(node => {\n          if (addedNodes.includes(node)) {\n            addedNodes.splice(addedNodes.indexOf(node), 1)\n          } else {\n            removedNodes.push(node)\n          }\n        })\n        mutation.addedNodes.forEach(node => {\n          if (removedNodes.includes(node)) {\n            removedNodes.splice(removedNodes.indexOf(node), 1)\n          } else {\n            addedNodes.push(node)\n          }\n        })\n      })\n      if (!addedNodes.length && !removedNodes.length) { return }\n      let contentChanged = false\n      let stylesChanged = false;\n      [...addedNodes, ...removedNodes].forEach(node => {\n        if (contentChanged && stylesChanged) { return }\n        if (node.matches('script[type=\"text/markdown\"]') && !this.src) {\n          contentChanged = true\n        } else if (node.tagName === 'TEMPLATE') {\n          stylesChanged = true\n        }\n      })\n      observeChildren(addedNodes)\n      if (contentChanged && !this.manualRender) { this.refreshContent() }\n      if (stylesChanged && !this.manualRender) { this.refreshStyles() }\n    })\n    rootObserver.observe(this, { childList: true })\n    observeChildren(this.children)\n  }\n\n  // Construct styles dom and return document fragment\n  buildStyles () {\n    const get = query => {\n      const node = this.querySelector(query)\n      return node ? node.innerHTML || ' ' : ''\n    }\n    const urls = this.arrify(this.config.cssUrls)\n    const html = `<div class=\"markdown-styles\"><style>${\n      this.config.hostCss}</style>${\n      get('template[data-merge=\"prepend\"]')}${\n      get('template:not([data-merge])') || urls.reduce((a, c) => `${a}<link rel=\"stylesheet\" href=\"${c}\">`, '')}${\n      get('template[data-merge=\"append\"]')}</div>`\n    return this.makeFrag(html)\n  }\n\n  // Construct md nodes and return promise that resolves to doc frag\n  async buildMd (opts = {}) {\n    const src = async () => {\n      if (!this.src) { return '' }\n      const resp = await fetch(this.src)\n      if (resp.ok) {\n        const md = await resp.text()\n        return window.marked(md, { baseUrl: this.getBaseUrl(this.src), ...opts })\n      } else {\n        this.fire('zero-md-error', { msg: `[zero-md] HTTP error ${resp.status} while fetching src`, status: resp.status, src: this.src })\n        return ''\n      }\n    }\n    const script = () => {\n      const el = this.querySelector('script[type=\"text/markdown\"]')\n      if (!el) { return '' }\n      const md = el.hasAttribute('data-dedent') ? this.dedent(el.text) : el.text\n      return window.marked(md, opts)\n    }\n    const html = `<div class=\"markdown-body${\n      opts.classes ? this.arrify(opts.classes).reduce((a, c) => `${a} ${c}`, ' ') : ''}\">${\n      await src() || script()}</div>`\n    const frag = this.makeFrag(html)\n    this.highlight(frag.firstElementChild)\n    return frag\n  }\n\n  // Stamps a fragment into DOM\n  async stampDom (frag) {\n    const links = [...frag.querySelectorAll('link[rel=\"stylesheet\"]')]\n    const element = this.root.appendChild(frag.firstElementChild)\n    // Wrap all link elements with onload listener\n    await Promise.all(links.map(l => this.onload(l))).catch(err => {\n      this.fire('zero-md-error', { msg: '[zero-md] An external stylesheet failed to load', status: undefined, src: err.href })\n    })\n    return element\n  }\n\n  async render (opts = {}) {\n    await this.waitForReady()\n    this.clearDom()\n    const css = this.buildStyles()\n    const md = this.buildMd(opts)\n    this._stampedStyles = await this.stampDom(css)\n    await this.tick()\n    this._stampedBody = await this.stampDom(await md)\n    this.fire('zero-md-rendered')\n  }\n\n  async refreshContent (opts = {}) {\n    const md = await this.buildMd(opts)\n    if (this._stampedBody) {\n      const mdElement = md.firstElementChild\n      this._stampedBody.replaceWith(mdElement)\n      this._stampedBody = mdElement\n    } else {\n      this._stampedBody = await this.stampDom(md)\n    }\n    this.fire('zero-md-rendered', { partial: true, part: 'body' })\n  }\n\n  async refreshStyles () {\n    const css = this.buildStyles()\n    if (this._stampedStyles) {\n      const cssElement = css.firstElementChild\n      this._stampedStyles.replaceWith(cssElement)\n      this._stampedStyles = cssElement\n    } else {\n      this._stampedStyles = await this.stampDom(css)\n    }\n    await this.tick()\n    this.fire('zero-md-rendered', { partial: true, part: 'styles' })\n  }\n}\n\ncustomElements.define('zero-md', ZeroMd)\n"],"names":["ZeroMd","HTMLElement","src","this","getAttribute","val","reflect","manualRender","hasAttribute","[object Object]","name","removeAttribute","setAttribute","observedAttributes","old","connected","render","defaults","super","version","config","markedUrl","prismUrl","cssUrls","hostCss","window","ZeroMdConfig","root","attachShadow","mode","constructor","ready","Promise","all","marked","loadScript","Prism","clicked","bind","then","setTimeout","goto","location","hash","_stampedBody","_stampedStyles","observeChanges","fire","bubbles","composed","waitForReady","shadowRoot","addEventListener","removeEventListener","resolve","handler","detail","opts","msg","console","warn","dispatchEvent","CustomEvent","node","requestAnimationFrame","any","Array","isArray","reject","onload","onerror","err","path","composedPath","urls","arrify","map","item","url","attrs","el","document","createElement","async","forEach","attr","head","appendChild","id","getElementById","substring","scrollIntoView","ev","metaKey","ctrlKey","altKey","shiftKey","defaultPrevented","a","target","closest","host","pathname","querySelectorAll","n","remove","html","tpl","innerHTML","content","str","match","replace","RegExp","href","lastIndexOf","container","lang","innerText","classList","add","highlightAllUnder","stylesObserver","MutationObserver","refreshStyles","inlineContentObserver","refreshContent","observeChildren","nodes","observeConfig","childList","attributes","characterData","subtree","matches","observe","tagName","mutations","addedNodes","removedNodes","mutation","includes","splice","indexOf","push","length","contentChanged","stylesChanged","children","get","query","querySelector","reduce","c","makeFrag","classes","resp","fetch","ok","md","text","baseUrl","getBaseUrl","status","dedent","script","frag","highlight","firstElementChild","links","element","l","catch","undefined","clearDom","css","buildStyles","buildMd","stampDom","tick","mdElement","replaceWith","partial","part","cssElement","customElements","define"],"mappings":"AAAO,MAAMA,UAAeC,YAC1BC,UAAa,OAAOC,KAAKC,aAAa,OACtCF,QAASG,GAAOF,KAAKG,QAAQ,MAAOD,GACpCE,mBAAsB,OAAOJ,KAAKK,aAAa,iBAC/CD,iBAAkBF,GAAOF,KAAKG,QAAQ,gBAAiBD,GAEvDI,QAASC,EAAML,IACD,IAARA,EACFF,KAAKQ,gBAAgBD,GAErBP,KAAKS,aAAaF,GAAc,IAARL,EAAe,GAAKA,GAIhDQ,gCACE,MAAO,CAAC,OAGVJ,yBAA0BC,EAAMI,EAAKT,GACtB,QAATK,GAAkBP,KAAKY,YAAcZ,KAAKI,cAAgBF,IAAQS,GACpEX,KAAKa,SAITP,YAAaQ,GACXC,QACAf,KAAKgB,QAAU,QACfhB,KAAKiB,OAAS,CACZC,UAAW,8DACXC,SAAU,CACR,CAAC,2DAA4D,eAC7D,0FAEFC,QAAS,CACP,yFACA,oEAEFC,QAAS,2FACNP,KACAQ,OAAOC,cAEZvB,KAAKwB,KAAOxB,KAAKK,aAAa,aAAeL,KAAOA,KAAKyB,aAAa,CAAEC,KAAM,SACzE1B,KAAK2B,YAAYC,QACpB5B,KAAK2B,YAAYC,MAAQC,QAAQC,IAAI,GACjCR,OAAOS,QAAU/B,KAAKgC,WAAWhC,KAAKiB,OAAOC,aAC7CI,OAAOW,OAASjC,KAAKgC,WAAWhC,KAAKiB,OAAOE,aAGlDnB,KAAKkC,QAAUlC,KAAKkC,QAAQC,KAAKnC,MAC5BA,KAAKI,cAGRJ,KAAKa,SAASuB,MAAK,IAAMC,YAAW,IAAMrC,KAAKsC,KAAKC,SAASC,OAAO,OAEtExC,KAAKyC,aAAe,KACpBzC,KAAK0C,eAAiB,KACtB1C,KAAK2C,iBAGPrC,oBACEN,KAAKY,WAAY,EACjBZ,KAAK4C,KAAK,oBAAqB,GAAI,CAAEC,SAAS,EAAOC,UAAU,IAC/D9C,KAAK+C,eAAeX,MAAK,KACvBpC,KAAK4C,KAAK,oBAER5C,KAAKgD,YACPhD,KAAKgD,WAAWC,iBAAiB,QAASjD,KAAKkC,SAInD5B,uBACEN,KAAKY,WAAY,EACbZ,KAAKgD,YACPhD,KAAKgD,WAAWE,oBAAoB,QAASlD,KAAKkC,SAItD5B,eACE,MAAMsB,EAAQ5B,KAAKY,WAAa,IAAIiB,SAAQsB,IAC1CnD,KAAKiD,iBAAiB,qBAAqB,SAASG,IAClDpD,KAAKkD,oBAAoB,oBAAqBE,GAC9CD,UAGJ,OAAOtB,QAAQC,IAAI,CAAC9B,KAAK2B,YAAYC,MAAOA,IAG9CtB,KAAMC,EAAM8C,EAAS,GAAIC,EAAO,CAAET,SAAS,EAAMC,UAAU,IACrDO,EAAOE,KACTC,QAAQC,KAAKJ,EAAOE,KAEtBvD,KAAK0D,cAAc,IAAIC,YAAYpD,EAAM,CACvC8C,OAAQ,CAAEO,KAAM5D,QAASqD,MACtBC,KAIPhD,OACE,OAAO,IAAIuB,SAAQsB,GAAWU,sBAAsBV,KAItD7C,OAAQwD,GACN,OAAOA,EAAOC,MAAMC,QAAQF,GAAOA,EAAM,CAACA,GAAQ,GAIpDxD,OAAQsD,GACN,OAAO,IAAI/B,SAAQ,CAACsB,EAASc,KAC3BL,EAAKM,OAASf,EACdS,EAAKO,QAAUC,GAAOH,EAAOG,EAAIC,KAAOD,EAAIC,KAAK,GAAKD,EAAIE,eAAe,OAK7EhE,WAAYiE,GAEV,OADAA,EAAOvE,KAAKwE,OAAOD,GACZ1C,QAAQC,IAAIyC,EAAKE,KAAIC,IAC1B,MAAOC,KAAQC,GAAS5E,KAAKwE,OAAOE,GAC9BG,EAAKC,SAASC,cAAc,UAIlC,OAHAF,EAAG9E,IAAM4E,EACTE,EAAGG,OAAQ,EACXJ,EAAMK,SAAQC,GAAQL,EAAGpE,aAAayE,EAAM,MACrClF,KAAKkE,OAAOY,SAASK,KAAKC,YAAYP,QAKjDvE,KAAM+E,GACJ,GAAIA,EAAI,CACN,MAAMR,EAAK7E,KAAKwB,KAAK8D,eAAeD,EAAGE,UAAU,IAC7CV,GACFA,EAAGW,kBAMTlF,QAASmF,GACP,GAAIA,EAAGC,SAAWD,EAAGE,SAAWF,EAAGG,QAAUH,EAAGI,UAAYJ,EAAGK,iBAC7D,OAEF,MAAMC,EAAIN,EAAGO,OAAOC,QAAQ,KACxBF,GAAKA,EAAEvD,MAAQuD,EAAEG,OAAS3D,SAAS2D,MAAQH,EAAEI,WAAa5D,SAAS4D,UACrEnG,KAAKsC,KAAKyD,EAAEvD,MAIhBlC,WACgBN,KAAKwB,KAAK4E,iBAAiB,qBACnCnB,SAAQoB,GAAKA,EAAEC,WAIvBhG,SAAUiG,GACR,MAAMC,EAAM1B,SAASC,cAAc,YAEnC,OADAyB,EAAIC,UAAYF,EACTC,EAAIE,QAGbpG,OAAQqG,GAEN,MAAMC,GADND,EAAMA,EAAIE,QAAQ,MAAO,KACPD,MAAM,QACxB,OAAOA,EAAQD,EAAIE,QAAQ,IAAIC,OAAO,IAAIF,EAAM,KAAM,MAAO,IAAMD,EAGrErG,WAAYP,GACV,MAAMgG,EAAIjB,SAASC,cAAc,KAEjC,OADAgB,EAAEgB,KAAOhH,EACFgG,EAAEgB,KAAKxB,UAAU,EAAGQ,EAAEgB,KAAKC,YAAY,KAAO,GAGvD1G,UAAW2G,GACQA,EAAUb,iBAAiB,sCACnCnB,SAAQoB,IAEf,MAAMa,EAAOb,EAAEc,UAAUP,MAAM,SAAW,SAAWP,EAAEc,UAAUP,MAAM,cAAgB,OAAS,KAChGP,EAAEe,UAAUC,IAAI,YAAYH,QAE9B5F,OAAOW,MAAMqF,kBAAkBL,GAIjC3G,iBACE,MAAMiH,EAAiB,IAAIC,kBAAiB,KACrCxH,KAAKI,cAAgBJ,KAAKyH,mBAE3BC,EAAwB,IAAIF,kBAAiB,KAC5CxH,KAAKI,cAAgBJ,KAAK2H,oBAE3BC,EAAkBC,GAAS,IAAIA,GAAO5C,SAAQrB,IAClD,MAAMkE,EAAgB,CAAEC,WAAW,EAAMC,YAAY,EAAMC,eAAe,EAAMC,SAAS,GACrFtE,EAAKuE,QAAQ,gCACfT,EAAsBU,QAAQxE,EAAMkE,GACV,aAAjBlE,EAAKyE,SACdd,EAAea,QAAQxE,EAAK8C,QAASoB,MAGpB,IAAIN,kBAAkBc,IACzC,MAAMC,EAAa,GACbC,EAAe,GAiBrB,GAhBAF,EAAUrD,SAAQwD,IAChBA,EAASD,aAAavD,SAAQrB,IACxB2E,EAAWG,SAAS9E,GACtB2E,EAAWI,OAAOJ,EAAWK,QAAQhF,GAAO,GAE5C4E,EAAaK,KAAKjF,MAGtB6E,EAASF,WAAWtD,SAAQrB,IACtB4E,EAAaE,SAAS9E,GACxB4E,EAAaG,OAAOH,EAAaI,QAAQhF,GAAO,GAEhD2E,EAAWM,KAAKjF,UAIjB2E,EAAWO,SAAWN,EAAaM,OAAU,OAClD,IAAIC,GAAiB,EACjBC,GAAgB,EACpB,IAAIT,KAAeC,GAAcvD,SAAQrB,IACnCmF,GAAkBC,IAClBpF,EAAKuE,QAAQ,kCAAoCnI,KAAKD,IACxDgJ,GAAiB,EACS,aAAjBnF,EAAKyE,UACdW,GAAgB,OAGpBpB,EAAgBW,GACZQ,IAAmB/I,KAAKI,cAAgBJ,KAAK2H,iBAC7CqB,IAAkBhJ,KAAKI,cAAgBJ,KAAKyH,mBAErCW,QAAQpI,KAAM,CAAE+H,WAAW,IACxCH,EAAgB5H,KAAKiJ,UAIvB3I,cACE,MAAM4I,EAAMC,IACV,MAAMvF,EAAO5D,KAAKoJ,cAAcD,GAChC,OAAOvF,EAAOA,EAAK6C,WAAa,IAAM,IAElClC,EAAOvE,KAAKwE,OAAOxE,KAAKiB,OAAOG,SAC/BmF,EAAO,uCACXvG,KAAKiB,OAAOI,kBACZ6H,EAAI,oCACJA,EAAI,+BAAiC3E,EAAK8E,QAAO,CAACtD,EAAGuD,IAAM,GAAGvD,iCAAiCuD,OAAO,MACtGJ,EAAI,yCACN,OAAOlJ,KAAKuJ,SAAShD,GAIvBjG,cAAegD,EAAO,IACpB,MAiBMiD,EAAO,4BACXjD,EAAKkG,QAAUxJ,KAAKwE,OAAOlB,EAAKkG,SAASH,QAAO,CAACtD,EAAGuD,IAAM,GAAGvD,KAAKuD,KAAK,KAAO,YAlBpEtE,WACV,IAAKhF,KAAKD,IAAO,MAAO,GACxB,MAAM0J,QAAaC,MAAM1J,KAAKD,KAC9B,GAAI0J,EAAKE,GAAI,CACX,MAAMC,QAAWH,EAAKI,OACtB,OAAOvI,OAAOS,OAAO6H,EAAI,CAAEE,QAAS9J,KAAK+J,WAAW/J,KAAKD,QAASuD,IAGlE,OADAtD,KAAK4C,KAAK,gBAAiB,CAAEW,IAAK,wBAAwBkG,EAAKO,4BAA6BA,OAAQP,EAAKO,OAAQjK,IAAKC,KAAKD,MACpH,IAWHA,IARO,MACb,MAAM8E,EAAK7E,KAAKoJ,cAAc,gCAC9B,IAAKvE,EAAM,MAAO,GAClB,MAAM+E,EAAK/E,EAAGxE,aAAa,eAAiBL,KAAKiK,OAAOpF,EAAGgF,MAAQhF,EAAGgF,KACtE,OAAOvI,OAAOS,OAAO6H,EAAItG,IAIV4G,WACXC,EAAOnK,KAAKuJ,SAAShD,GAE3B,OADAvG,KAAKoK,UAAUD,EAAKE,mBACbF,EAIT7J,eAAgB6J,GACd,MAAMG,EAAQ,IAAIH,EAAK/D,iBAAiB,2BAClCmE,EAAUvK,KAAKwB,KAAK4D,YAAY+E,EAAKE,mBAK3C,aAHMxI,QAAQC,IAAIwI,EAAM7F,KAAI+F,GAAKxK,KAAKkE,OAAOsG,MAAKC,OAAMrG,IACtDpE,KAAK4C,KAAK,gBAAiB,CAAEW,IAAK,kDAAmDyG,YAAQU,EAAW3K,IAAKqE,EAAI2C,UAE5GwD,EAGTjK,aAAcgD,EAAO,UACbtD,KAAK+C,eACX/C,KAAK2K,WACL,MAAMC,EAAM5K,KAAK6K,cACXjB,EAAK5J,KAAK8K,QAAQxH,GACxBtD,KAAK0C,qBAAuB1C,KAAK+K,SAASH,SACpC5K,KAAKgL,OACXhL,KAAKyC,mBAAqBzC,KAAK+K,eAAenB,GAC9C5J,KAAK4C,KAAK,oBAGZtC,qBAAsBgD,EAAO,IAC3B,MAAMsG,QAAW5J,KAAK8K,QAAQxH,GAC9B,GAAItD,KAAKyC,aAAc,CACrB,MAAMwI,EAAYrB,EAAGS,kBACrBrK,KAAKyC,aAAayI,YAAYD,GAC9BjL,KAAKyC,aAAewI,OAEpBjL,KAAKyC,mBAAqBzC,KAAK+K,SAASnB,GAE1C5J,KAAK4C,KAAK,mBAAoB,CAAEuI,SAAS,EAAMC,KAAM,SAGvD9K,sBACE,MAAMsK,EAAM5K,KAAK6K,cACjB,GAAI7K,KAAK0C,eAAgB,CACvB,MAAM2I,EAAaT,EAAIP,kBACvBrK,KAAK0C,eAAewI,YAAYG,GAChCrL,KAAK0C,eAAiB2I,OAEtBrL,KAAK0C,qBAAuB1C,KAAK+K,SAASH,SAEtC5K,KAAKgL,OACXhL,KAAK4C,KAAK,mBAAoB,CAAEuI,SAAS,EAAMC,KAAM,YAIzDE,eAAeC,OAAO,UAAW1L"}