{"version":3,"file":"zero-md.legacy.min.js","sources":["../src/index.js"],"sourcesContent":["export class ZeroMd extends HTMLElement {\n  get src() {\n    return this.getAttribute('src')\n  }\n\n  get path() {\n    return this.getAttribute('path')\n  }\n\n  set src(val) {\n    this.reflect('src', val)\n  }\n\n  set path(val) {\n    this.reflect('path', val)\n  }\n\n  get manualRender() {\n    return this.hasAttribute('manual-render')\n  }\n\n  set manualRender(val) {\n    this.reflect('manual-render', val)\n  }\n\n  reflect(name, val) {\n    if (val === false) {\n      this.removeAttribute(name)\n    } else {\n      this.setAttribute(name, val === true ? '' : val)\n    }\n  }\n\n  static get observedAttributes() {\n    return ['src', 'path']\n  }\n\n  attributeChangedCallback(name, old, val) {\n    if (\n      (name === 'src' || name === 'path') &&\n      this.connected &&\n      !this.manualRender &&\n      val !== old\n    ) {\n      this.render()\n    }\n  }\n\n  constructor(defaults) {\n    super()\n    this.version = '$VERSION'\n    this.config = {\n      markedUrl: 'https://cdn.jsdelivr.net/gh/markedjs/marked@2/marked.min.js',\n      prismUrl: [\n        ['https://cdn.jsdelivr.net/gh/PrismJS/prism@1/prism.min.js', 'data-manual'],\n        'https://cdn.jsdelivr.net/gh/PrismJS/prism@1/plugins/autoloader/prism-autoloader.min.js'\n      ],\n      cssUrls: [\n        'https://cdn.jsdelivr.net/gh/sindresorhus/github-markdown-css@4/github-markdown.min.css',\n        'https://cdn.jsdelivr.net/gh/PrismJS/prism@1/themes/prism.min.css'\n      ],\n      hostCss:\n        ':host{display:block;position:relative;contain:content;}:host([hidden]){display:none;}',\n      baseUrl: '',\n      gitlab: {\n        token: null,\n        projectId: null,\n        path: null,\n        branch: 'master',\n        ...window.ZeroMdConfig.gitlab\n      },\n      shortBreaksNumber: 2,\n      longBreaksNumber: 20,\n      anchorIdsToLowerCase: true,\n      indentInsideTocByPixels: 40,\n      imgBaseOld: './resources',\n      imgBaseNew: 'https://github.com/yashaka/taotaspy-resources/raw/master',\n      pTagLang: undefined, // expect string with something like \"en-us\", \"ru\", etc...\n      ...defaults,\n      ...window.ZeroMdConfig\n    }\n    this.cache = {}\n    this.root = this.hasAttribute('no-shadow') ? this : this.attachShadow({ mode: 'open' })\n    if (!this.constructor.ready) {\n      this.constructor.ready = Promise.all([\n        !!window.marked || this.loadScript(this.config.markedUrl),\n        !!window.Prism || this.loadScript(this.config.prismUrl)\n      ])\n    }\n    this.clicked = this.clicked.bind(this)\n    if (!this.manualRender) {\n      // Scroll to hash id after first render. However, `history.scrollRestoration` inteferes with this\n      // on refresh. It's much better to use a `setTimeout` rather than to alter the browser's behaviour.\n      this.render().then(() => setTimeout(() => this.goto(location.hash), 250))\n    }\n    this.observer = new MutationObserver(async () => {\n      this.observeChanges()\n      if (!this.manualRender) {\n        await this.render()\n      }\n    })\n    this.observeChanges()\n  }\n\n  connectedCallback() {\n    this.connected = true\n    this.fire('zero-md-connected', {}, { bubbles: false, composed: false })\n    this.waitForReady().then(() => {\n      this.fire('zero-md-ready')\n    })\n    if (this.shadowRoot) {\n      this.shadowRoot.addEventListener('click', this.clicked)\n    }\n  }\n\n  disconnectedCallback() {\n    this.connected = false\n    if (this.shadowRoot) {\n      this.shadowRoot.removeEventListener('click', this.clicked)\n    }\n  }\n\n  waitForReady() {\n    const ready =\n      this.connected ||\n      new Promise((resolve) => {\n        this.addEventListener('zero-md-connected', function handler() {\n          this.removeEventListener('zero-md-connected', handler)\n          resolve()\n        })\n      })\n    return Promise.all([this.constructor.ready, ready])\n  }\n\n  fire(name, detail = {}, opts = { bubbles: true, composed: true }) {\n    if (detail.msg) {\n      console.warn(detail.msg)\n    }\n    this.dispatchEvent(\n      new CustomEvent(name, {\n        detail: { node: this, ...detail },\n        ...opts\n      })\n    )\n  }\n\n  tick() {\n    return new Promise((resolve) => requestAnimationFrame(resolve))\n  }\n\n  // Coerce anything into an array\n  arrify(any) {\n    return any ? (Array.isArray(any) ? any : [any]) : []\n  }\n\n  // Promisify an element's onload callback\n  onload(node) {\n    return new Promise((resolve, reject) => {\n      node.onload = resolve\n      node.onerror = (err) => reject(err.path ? err.path[0] : err.composedPath()[0])\n    })\n  }\n\n  // Load a url or load (in order) an array of urls via <script> tags\n  loadScript(urls) {\n    return Promise.all(\n      this.arrify(urls).map((item) => {\n        const [url, ...attrs] = this.arrify(item)\n        const el = document.createElement('script')\n        el.src = url\n        el.async = false\n        attrs.forEach((attr) => el.setAttribute(attr, ''))\n        return this.onload(document.head.appendChild(el))\n      })\n    )\n  }\n\n  // Scroll to selected element\n  goto(id) {\n    if (id) {\n      const el = this.root.getElementById(id.substring(1))\n      if (el) {\n        el.scrollIntoView()\n      }\n    }\n  }\n\n  // Hijack same-doc anchor hash links\n  clicked(ev) {\n    if (ev.metaKey || ev.ctrlKey || ev.altKey || ev.shiftKey || ev.defaultPrevented) {\n      return\n    }\n    const a = ev.target.closest('a')\n    if (a && a.hash && a.host === location.host && a.pathname === location.pathname) {\n      this.goto(a.hash)\n    }\n  }\n\n  dedent(str) {\n    str = str.replace(/^\\n/, '')\n    const match = str.match(/^\\s+/)\n    return match ? str.replace(new RegExp(`^${match[0]}`, 'gm'), '') : str\n  }\n\n  getBaseUrl(src) {\n    const a = document.createElement('a')\n    a.href = src\n    return a.href.substring(0, a.href.lastIndexOf('/') + 1)\n  }\n\n  // Runs Prism highlight async; falls back to sync if Web Workers throw\n  highlight(container) {\n    return new Promise((resolve) => {\n      const unhinted = container.querySelectorAll('pre>code:not([class*=\"language-\"])')\n      unhinted.forEach((n) => {\n        // Dead simple language detection :)\n        const lang = n.innerText.match(/^\\s*</)\n          ? 'markup'\n          : n.innerText.match(/^\\s*(\\$|#)/)\n          ? 'bash'\n          : 'js'\n        n.classList.add(`language-${lang}`)\n      })\n      try {\n        window.Prism.highlightAllUnder(container, true, resolve())\n      } catch {\n        window.Prism.highlightAllUnder(container)\n        resolve()\n      }\n    })\n  }\n\n  // Converts HTML string into node\n  makeNode(html) {\n    const tpl = document.createElement('template')\n    tpl.innerHTML = html\n    return tpl.content.firstElementChild\n  }\n\n  // Construct styles dom and return HTML string\n  buildStyles() {\n    const get = (query) => {\n      const node = this.querySelector(query)\n      return node ? node.innerHTML || ' ' : ''\n    }\n    const urls = this.arrify(this.config.cssUrls)\n    const html = `<div class=\"markdown-styles\"><style>${this.config.hostCss}</style>${get(\n      'template[data-merge=\"prepend\"]'\n    )}${\n      get('template:not([data-merge])') ||\n      urls.reduce((a, c) => `${a}<link rel=\"stylesheet\" href=\"${c}\">`, '')\n    }${get('template[data-merge=\"append\"]')}</div>`\n    return html\n  }\n\n  // Construct md nodes and return HTML string\n  async buildMd(opts = {}) {\n    const src = async () => {\n      if (!this.src && !this.path) {\n        return ''\n      }\n\n      let absoluteUrl = ''\n      let isReadingFromGitlabConfigured = this.config.gitlab !== {}\n      const resp =\n        isReadingFromGitlabConfigured && this.path\n          ? await (async () => {\n              const id = this.config.gitlab.projectId\n              const branch = this.config.gitlab.branch\n              const absolutePath = encodeURIComponent(this.path)\n              absoluteUrl = `https://gitlab.com/api/v4/projects/${id}/repository/files/${absolutePath}/raw?ref=${branch}`\n\n              return fetch(absoluteUrl, {\n                headers: {\n                  'PRIVATE-TOKEN': this.config.gitlab.token\n                }\n              })\n            })()\n          : await (async () => {\n              const url = this.src\n              absoluteUrl = url.trim().startsWith('http') ? url : this.config.baseUrl + url\n\n              return fetch(absoluteUrl)\n            })()\n\n      if (resp.ok) {\n        let md = await resp.text()\n\n        /* PROCESS MD */\n        const renderer = new window.marked.Renderer()\n\n        const poetryBoldOption = /<!--(.+)poetryBold(.+)-->/i\n\n        const [, poetryBoldStart, poetryBoldEnd] = md.match(poetryBoldOption) || [null, '__', '__']\n        const boldRegExpRule = [\n          new RegExp(`${poetryBoldStart}(.*?)${poetryBoldEnd}`, 'gmi'),\n          '<b>$1</b>'\n        ]\n\n        let tocLinks = []\n        const tocStartLevelOption = /<!--TOC>(\\d)-->/i\n        const [, tocStartLevel] = md.match(tocStartLevelOption) || [null, 0]\n        renderer.heading = (text, level) => {\n          const notAUnicodeWord =\n            /[^_0-9a-zA-Z\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16F1-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]+/g\n          const [, pure, userId] = text.match(/^(.*)?\\s*{#(.*)}$/im) || [null, text]\n          const pureWithoutTags = pure.replace(/<\\/?\\w+>/g, '')\n          const anchorIdsToLowerCase = this.config.anchorIdsToLowerCase\n          const id =\n            userId ||\n            (anchorIdsToLowerCase\n              ? pureWithoutTags.toLowerCase().replace(notAUnicodeWord, '-')\n              : pureWithoutTags.replace(notAUnicodeWord, '-'))\n          const pixelsNumber = this.config.indentInsideTocByPixels\n\n          if (level > tocStartLevel) {\n            const indentInsideToc = `style=\"margin-left: ${\n              pixelsNumber * (level - 1 - tocStartLevel)\n            }px\"`\n            tocLinks.push(`<div ${indentInsideToc}><a href=\"#${id}\">${pureWithoutTags}</a></div>`)\n          }\n\n          return `<h${level}>${encodeURI(id) === id ? '' : `<span id=\"${encodeURI(id)}\"></span>`}\n          <a id=\"${id}\" class=\"anchor\" aria-hidden=\"true\" href=\"#${id}\"></a>${pure}</h${level}>`\n        }\n\n        const imgBase = /]\\(\\.\\.?\\/resources/gim // todo: move ../resources to config\n        md = md.replace(imgBase, '](' + this.config.imgBaseNew)\n\n        const shortBreaks = /^,,,,+/gim\n        md = md.replace(shortBreaks, '<br/>'.repeat(this.config.shortBreaksNumber))\n\n        const longBreaks = /^====+/gim\n        md = md.replace(longBreaks, '<br/>'.repeat(this.config.longBreaksNumber))\n\n        const pageBreaks = /^===/gim\n        md = md.replace(pageBreaks, '<div style=\"page-break-after: always;\"></div>')\n\n        const pythonCodeHighlightingWorkaround = /```python/gim\n        md = md.replace(pythonCodeHighlightingWorkaround, '```')\n\n        const javaCodeHighlightingWorkaround = /```java/gim\n        md = md.replace(javaCodeHighlightingWorkaround, '```')\n\n        // todo: fix to skip links that start with http\n        const mdExtensions = /\\.md\\)/gim\n        md = md.replace(mdExtensions, '-md)')\n\n        const mdExtensionsWithId = /\\.md#/gim\n        md = md.replace(mdExtensionsWithId, '-md#')\n\n        // todo: change to ```poetry ... ``` style\n        const poetries = /---[a-z]*\\n([\\s\\S]*?)\\n---/gim\n        const backTickPoetries = /```poetry[a-z]*\\n([\\s\\S]*?)\\n```/gim\n        const rules = [\n          [/(___)(.*?)\\1/gim, '<em>$2</em>'], //emphasis\n\n          boldRegExpRule, //bold1\n          [/(\\*\\*)(.*?)\\1/gim, '<b>$2</b>'], //bold2\n\n          // [/^(?!.*\\/\\*.*$).*(\\*)(.*?)\\1/gmi,      '<em>$2</em>'], //emphasis\n          // TODO: fix: does not work for lines: ... * ... * ... /* ... */ ...\n          // read for more info:\n          //    https://stackoverflow.com/questions/7376238/javascript-regex-look-behind-alternative\n\n          [/(____)(.*?)\\1/gim, '<span style=\"text-decoration:underline\">$2</span>'] //underlined\n        ]\n        const isOriginalUnderscoredBoldDisabled = poetryBoldStart !== '__'\n        const processPoetry = (rules) => (match, code) => {\n          let res = code\n\n          for (const rule of rules) {\n            // console.log(rule);\n            res = res.replace(rule[0], rule[1])\n          }\n\n          if (isOriginalUnderscoredBoldDisabled) {\n            res.replace(/(__)(.*?)\\1/gim, '‡‡‡$2‡‡‡') // to encode original __\n          }\n\n          // return `<pre><code>${res}</code></pre>`;\n          return `<pre>${res}</pre>`\n        }\n\n        md = md.replace(poetries, processPoetry(rules))\n        md = md.replace(backTickPoetries, processPoetry(rules))\n\n        /* GET HTML */\n\n        let html = window.marked(md, {\n          baseUrl: this.getBaseUrl(absoluteUrl),\n          renderer,\n          ...opts\n        })\n\n        /* PROCESS HTML */\n\n        if (isOriginalUnderscoredBoldDisabled) {\n          html = html.replace(/‡‡‡/gim, '__')\n        }\n\n        const tocMarker = /\\[toc\\]/i\n        const toc = `<div class=\"toc\">${tocLinks.join('')}</div>`\n        html = html.replace(tocMarker, toc)\n\n        return html\n      } else {\n        this.fire('zero-md-error', {\n          msg: `[zero-md] HTTP error ${resp.status} while fetching src`,\n          status: resp.status,\n          src: this.src\n        })\n        return ''\n      }\n    }\n    const script = () => {\n      const el = this.querySelector('script[type=\"text/markdown\"]')\n      if (!el) {\n        return ''\n      }\n      const md = el.hasAttribute('data-dedent') ? this.dedent(el.text) : el.text\n      return window.marked(md, opts)\n    }\n    const html = `<div class=\"markdown-body${\n      opts.classes ? this.arrify(opts.classes).reduce((a, c) => `${a} ${c}`, ' ') : ''\n    }\">${(await src()) || script()}</div>`\n    return html\n  }\n\n  // Insert or replace HTML styles string into DOM and wait for links to load\n  async stampStyles(html) {\n    const node = this.makeNode(html)\n    const links = [...node.querySelectorAll('link[rel=\"stylesheet\"]')]\n    const target = [...this.root.children].find((n) => n.classList.contains('markdown-styles'))\n    if (target) {\n      target.replaceWith(node)\n    } else {\n      this.root.prepend(node)\n    }\n    await Promise.all(links.map((l) => this.onload(l))).catch((err) => {\n      this.fire('zero-md-error', {\n        msg: '[zero-md] An external stylesheet failed to load',\n        status: undefined,\n        src: err.href\n      })\n    })\n  }\n\n  // Insert or replace HTML body string into DOM and returns the node\n  stampBody(html) {\n    const node = this.makeNode(html)\n    const target = [...this.root.children].find((n) => n.classList.contains('markdown-body'))\n    if (target) {\n      target.replaceWith(node)\n    } else {\n      this.root.append(node)\n    }\n    return node\n  }\n\n  // Start observing for changes in root, templates and scripts\n  observeChanges() {\n    this.observer.observe(this, { childList: true })\n    this.querySelectorAll('template,script[type=\"text/markdown\"]').forEach((n) => {\n      this.observer.observe(n.content || n, {\n        childList: true,\n        subtree: true,\n        attributes: true,\n        characterData: true\n      })\n    })\n  }\n\n  async render(opts = {}) {\n    await this.waitForReady()\n    const stamped = {}\n    const pending = this.buildMd(opts)\n    const css = this.buildStyles()\n    if (css !== this.cache.styles) {\n      this.cache.styles = css\n      await this.stampStyles(css)\n      stamped.styles = true\n      await this.tick()\n    }\n    const md = await pending\n    if (md !== this.cache.body) {\n      this.cache.body = md\n      const node = this.stampBody(md)\n      stamped.body = true\n      await this.highlight(node)\n    }\n    this.fire('zero-md-rendered', { stamped })\n  }\n}\n\ncustomElements.define('zero-md', ZeroMd)\n"],"names":["ZeroMd","_HTMLElement","_inherits","_render","_stampStyles","_buildMd","_super","defaults","_this","_classCallCheck","this","call","version","config","_objectSpread","markedUrl","prismUrl","cssUrls","hostCss","baseUrl","gitlab","token","projectId","path","branch","window","ZeroMdConfig","shortBreaksNumber","longBreaksNumber","anchorIdsToLowerCase","indentInsideTocByPixels","imgBaseOld","imgBaseNew","pTagLang","undefined","cache","root","hasAttribute","_assertThisInitialized","attachShadow","mode","constructor","ready","Promise","all","marked","loadScript","Prism","clicked","bind","manualRender","render","then","setTimeout","goto","location","hash","observer","MutationObserver","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","observeChanges","stop","key","get","getAttribute","set","val","reflect","value","name","removeAttribute","setAttribute","old","connected","_this2","fire","bubbles","composed","waitForReady","shadowRoot","addEventListener","removeEventListener","_this3","resolve","handler","detail","opts","arguments","length","msg","console","warn","dispatchEvent","CustomEvent","node","requestAnimationFrame","any","Array","isArray","reject","onload","onerror","err","composedPath","urls","_this4","arrify","map","item","_this4$arrify","_this4$arrify2","url","attrs","slice","el","document","createElement","src","async","forEach","attr","head","appendChild","id","getElementById","substring","scrollIntoView","ev","metaKey","ctrlKey","altKey","shiftKey","defaultPrevented","a","target","closest","host","pathname","str","match","replace","RegExp","href","lastIndexOf","container","querySelectorAll","n","lang","innerText","classList","add","highlightAllUnder","_unused","html","tpl","innerHTML","content","firstElementChild","_this5","query","querySelector","concat","reduce","c","_callee5","script","_this6","_args5","_context5","_ref2","_callee4","absoluteUrl","resp","md","renderer","poetryBoldOption","_ref5","_ref6","poetryBoldStart","poetryBoldEnd","boldRegExpRule","tocLinks","tocStartLevelOption","_ref7","_ref8","tocStartLevel","imgBase","shortBreaks","longBreaks","pageBreaks","pythonCodeHighlightingWorkaround","javaCodeHighlightingWorkaround","mdExtensions","mdExtensionsWithId","poetries","backTickPoetries","rules","isOriginalUnderscoredBoldDisabled","processPoetry","_html","tocMarker","toc","_context4","abrupt","_callee2","absolutePath","_context2","encodeURIComponent","fetch","headers","t0","sent","_callee3","_context3","trim","startsWith","ok","text","Renderer","_slicedToArray","heading","level","notAUnicodeWord","_ref10","pure","userId","pureWithoutTags","toLowerCase","pixelsNumber","indentInsideToc","push","encodeURI","repeat","code","_step","res","_iterator","_createForOfIteratorHelper","s","done","rule","e","f","getBaseUrl","join","status","apply","dedent","classes","t1","t2","links","_this7","_context6","makeNode","_toConsumableArray","children","find","contains","replaceWith","prepend","l","catch","_callee6","_x","append","_this8","observe","childList","subtree","attributes","characterData","_callee7","stamped","pending","css","_args7","_context7","buildMd","buildStyles","styles","stampStyles","tick","body","stampBody","highlight","_wrapNativeSuper","HTMLElement","customElements","define"],"mappings":"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"}